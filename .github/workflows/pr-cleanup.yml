name: Cleanup PR Resources

on:
    pull_request:
        types: [closed]

jobs:
    cleanup:
        name: ðŸ§¹ Cleanup PR Resources
        runs-on: ubuntu-latest
        steps:
            - name: Delete PR Docker Image
              uses: actions/github-script@v7
              with:
                  script: |
                      const { owner, repo } = context.repo;
                      const prNumber = context.payload.pull_request.number;

                      try {
                          await github.rest.packages.deletePackageVersionForOrg({
                              package_type: 'container',
                              package_name: `${repo}/app`,
                              org: owner,
                              version: `pr-${prNumber}`
                          });
                      } catch (error) {
                          console.log('Error deleting package:', error);
                      }
