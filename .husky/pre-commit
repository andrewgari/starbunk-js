#!/bin/sh
set -e

echo "ğŸ” Running pre-commit validation checks..."

# Sync VERSION to package.json files
echo "ğŸ“¦ Syncing VERSION file to package.json files..."
if [ -f "config/VERSION" ]; then
  bash scripts/sync-versions.sh
  # Stage any package.json files that were updated
  git add package.json apps/*/package.json packages/shared/package.json 2>/dev/null || true
fi

# Repository structure validation
echo "ğŸ“ Validating repository structure..."
bash scripts/validation/check-root-directory.sh
bash scripts/validation/check-naming-conventions.sh
bash scripts/validation/check-temporary-files.sh

echo "ğŸ§¹ Running lint-staged (ESLint + Prettier on staged files)..."
npx lint-staged

echo "âœ… Pre-commit checks completed successfully!"
