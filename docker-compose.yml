services:
    bunkbot:
        build:
            context: .
            dockerfile: Dockerfile
        container_name: bunkbot
        env_file:
            - .env
        command: node --enable-source-maps dist/bunkbot.js
        # Improve performance with resource limits
        deploy:
            resources:
                limits:
                    cpus: '2'
                    memory: 1G
        volumes:
            - /mnt/user/vault/ttrpg/campaigns:/app/data/campaigns
            - ./scripts:/app/scripts
            - ./data/llm_context:/app/data/llm_context
            - ./data:/app/data
            - ./src/starbunk/bots/strategy-bots:/app/dist/starbunk/bots/strategy-bots
        environment:
            - PYTHONPATH=/app/scripts
            - VECTOR_CONTEXT_DIR=/app/data/llm_context
