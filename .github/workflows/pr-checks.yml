name: PR Checks

on:
    pull_request:
        types: [opened, synchronize]
    workflow_dispatch:

jobs:
    lint:
        uses: ./.github/workflows/lint.yml

    test:
        uses: ./.github/workflows/unit-tests.yml

    build:
        uses: ./.github/workflows/build.yml

    docker-build:
        uses: ./.github/workflows/docker-build.yml

    summary:
        needs: [lint, test, build, docker-build]
        runs-on: ubuntu-latest
        steps:
            - name: 📝 PR Checks Summary
              run: |
                  echo "### 🔍 PR Checks Summary" >> $GITHUB_STEP_SUMMARY
                  echo "| Check | Status |" >> $GITHUB_STEP_SUMMARY
                  echo "| --- | --- |" >> $GITHUB_STEP_SUMMARY
                  echo "| **Lint** | ${{ needs.lint.result == 'success' && '✅ Passed' || '❌ Failed' }} |" >> $GITHUB_STEP_SUMMARY
                  echo "| **Tests** | ${{ needs.test.result == 'success' && '✅ Passed' || '❌ Failed' }} |" >> $GITHUB_STEP_SUMMARY
                  echo "| **Build** | ${{ needs.build.result == 'success' && '✅ Passed' || '❌ Failed' }} |" >> $GITHUB_STEP_SUMMARY
                  echo "| **Docker Build** | ${{ needs.docker-build.result == 'success' && '✅ Passed' || '❌ Failed' }} |" >> $GITHUB_STEP_SUMMARY
