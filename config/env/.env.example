# =============================================================================
# DISCORD BOT TOKENS
# =============================================================================
# Get Discord bot tokens from: https://discord.com/developers/applications
#
# RECOMMENDED SETUP (Single Bot):
# Set STARBUNK_TOKEN and all containers will use it automatically.
# This is the simplest and most common configuration.
STARBUNK_TOKEN=your-discord-bot-token-here

# ADVANCED SETUP (Multiple Bots):
# If you want different Discord bots for different containers, set container-specific tokens.
# The code will check for container-specific tokens first, then fall back to STARBUNK_TOKEN.
#
# Uncomment and set these ONLY if you want to use different bots per container:
# BUNKBOT_TOKEN=your-bunkbot-specific-token-here       # BunkBot: Reply bots and admin commands
# DJCOVA_TOKEN=your-djcova-specific-token-here         # DJCova: Music service
# STARBUNK_DND_TOKEN=your-dnd-specific-token-here      # Starbunk-DND: D&D features and bridge
# COVABOT_TOKEN=your-covabot-specific-token-here       # CovaBot: AI personality

# SNOWBUNK_TOKEN: Uses a different token (production only)
# NEVER SET IN DEVELOPMENT - Only used in production deployments
# SNOWBUNK_TOKEN=your-production-snowbunk-token-here

# Legacy token (maintained for backward compatibility - not recommended for new setups)
# TOKEN=your-fallback-token-here

# =============================================================================
# DISCORD APPLICATION CONFIGURATION
# =============================================================================
# Discord application IDs and server configuration

# Primary Discord server/guild ID
GUILD_ID=753251582719688714

# Discord application client IDs (for slash command registration)
# STARBUNK_CLIENT_ID: Primary Discord application/client ID used by all containers
# Get this from Discord Developer Portal > Your Application > Application ID
# This is the bot's application ID (not the bot token)
#
# RECOMMENDED SETUP (Single Bot):
# Set STARBUNK_CLIENT_ID and all containers will use it automatically.
STARBUNK_CLIENT_ID=836445923105308672

# ADVANCED SETUP (Multiple Bots):
# If you're using different Discord applications per container, set container-specific client IDs.
# Uncomment and set these ONLY if you want different application IDs per container:
# BUNKBOT_CLIENT_ID=your-bunkbot-client-id-here
# COVABOT_CLIENT_ID=your-covabot-client-id-here

# Legacy client ID (maintained for backward compatibility - not recommended for new setups)
# CLIENT_ID=836445923105308672

# =============================================================================
# AI/LLM CONFIGURATION
# =============================================================================
# Configuration for AI services used by containers
#
# IMPORTANT: Ollama is the DEFAULT and PREFERRED provider.
# OpenAI and Gemini are OPT-IN ONLY - they will only be used if their API keys are explicitly set.

# Ollama (local LLM) configuration - PREFERRED
# This is the default provider for privacy, cost, and control
OLLAMA_API_URL=http://192.168.50.3:11434
OLLAMA_DEFAULT_MODEL=qwen2.5:7b

# Automatically pull missing Ollama models at runtime (default: true)
# When enabled, if a model is not found, the bot will automatically download it
# This may take several minutes for large models but prevents manual intervention
OLLAMA_AUTO_PULL_MODELS=true

# Pull missing models on startup (default: true)
# When enabled, the bot will check for and start downloading the configured model during startup
# The download runs asynchronously and does not block the bot from starting to process messages
# Set to false if you want to pull models only on-demand (first 404 error)
OLLAMA_PULL_ON_STARTUP=true

# Timeout for model pull operations in milliseconds (default: 1200000 = 20 minutes)
# Large models (70B+) can be 40+ GB and may require longer timeouts
# Increase this value if you're pulling very large models on slow connections
OLLAMA_PULL_TIMEOUT_MS=1200000

# OpenAI API configuration - OPT-IN ONLY
# OpenAI is disabled when OPENAI_API_KEY is unset or set to an empty value
# Only set this to a non-empty value if you explicitly want to use OpenAI
# OPENAI_API_KEY=your-openai-api-key-here
OPENAI_DEFAULT_MODEL=gpt-4o-mini

# Google Gemini API configuration - OPT-IN ONLY
# Get your free API key from: https://aistudio.google.com/app/apikey
# Gemini has a generous free tier (1500 requests/day for gemini-2.0-flash-exp)
# Gemini is disabled when GEMINI_API_KEY is unset or set to an empty value
# GEMINI_API_KEY=your-gemini-api-key-here
GEMINI_DEFAULT_MODEL=gemini-2.0-flash-exp

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# PostgreSQL Configuration
POSTGRES_DB=starbunk
POSTGRES_USER=starbunk
POSTGRES_PASSWORD=your-postgres-password
POSTGRES_PORT=5432

DATABASE_URL="postgresql://starbunk:your-postgres-password@192.168.50.3:5432/starbunk?schema=public"

# =============================================================================
# QDRANT VECTOR DATABASE CONFIGURATION
# =============================================================================
# Qdrant Configuration for CovaBot memory system
QDRANT_URL=http://192.168.50.3:6333
QDRANT_API_KEY=your-qdrant-api-key-here

# Embedding Configuration
EMBEDDING_MODEL=Xenova/all-MiniLM-L6-v2
EMBEDDING_DIMENSIONS=384
EMBEDDING_BATCH_SIZE=16
EMBEDDING_CACHE_SIZE=2000
EMBEDDING_TIMEOUT=60000

# Memory Collections
PERSONALITY_COLLECTION=covabot_personality
CONVERSATION_COLLECTION=covabot_conversations
MEMORY_COLLECTION=covabot_memory

# Performance Tuning
QDRANT_SEARCH_LIMIT=50
QDRANT_SIMILARITY_THRESHOLD=0.7
QDRANT_BATCH_SIZE=100

# =============================================================================
# OBSERVABILITY CONFIGURATION
# =============================================================================
# URLs for observability stack on LAN

# Prometheus server for metrics collection
PROMETHEUS_URL=http://192.168.50.3:9090

# Grafana dashboard server
GRAFANA_URL=http://192.168.50.3:3000

# Loki log aggregation server
LOKI_URL=http://192.168.50.3:3100

# Prometheus push gateway (optional, for batch metrics)
PROMETHEUS_PUSHGATEWAY_URL=http://192.168.50.3:9091

# Metrics and health check ports for each service (for Prometheus scraping)
BUNKBOT_METRICS_PORT=3002
BUNKBOT_HEALTH_PORT=3002
COVABOT_METRICS_PORT=3003
COVABOT_HEALTH_PORT=3003
DJCOVA_METRICS_PORT=3004
DJCOVA_HEALTH_PORT=3004
STARBUNK_DND_METRICS_PORT=3005
STARBUNK_DND_HEALTH_PORT=3005

# Observability configuration
ENABLE_METRICS=true
ENABLE_STRUCTURED_LOGGING=true
METRICS_PUSH_INTERVAL=30000
LOG_FORMAT=json

# Circuit breaker and performance tuning
CIRCUIT_BREAKER_THRESHOLD=10
ENABLE_RUNTIME_METRICS=true
HTTP_TIMEOUT=10000
HTTP_MAX_REQUEST_SIZE=1048576

# Optional authentication for metrics endpoints
METRICS_AUTH_TOKEN=

# =============================================================================
# WEBHOOK CONFIGURATION
# =============================================================================
# Optional webhook URL for Discord notifications
WEBHOOK_URL=https://discord.com/api/webhooks/your/webhook/url/here

# =============================================================================
# E2E LIVE TESTING (NO MOCKS)
# =============================================================================
# These settings are used by the live E2E tests that exercise the actual pipeline.
# Never point these at production. Only run in a non-prod test server/channel that you control.
# When DEBUG_MODE is true, bots will only respond in channels listed in TESTING_CHANNEL_IDS.
#
# Webhook that the E2E runner will post messages to (test server only)
E2E_TEST_WEBHOOK_URL=https://discord.com/api/webhooks/your/test/webhook/url
# Guild and channel that the runner should target/monitor during tests
E2E_TEST_SERVER_ID=
E2E_TEST_CHANNEL_ID=
# Discord token for the monitoring client that listens for bunkbot replies (can be STARBUNK_TOKEN)
E2E_MONITOR_TOKEN=
# Safety switch to allow webhook-originated messages to be processed by bots in whitelisted channels
E2E_ALLOW_WEBHOOK_TESTS=false
# Timeouts and pacing
E2E_TIMEOUT_MS=20000
E2E_DELAY_MS=2000

# Optional: include chance-based bots in E2E (non-blocking)
E2E_INCLUDE_CHANCE_BOTS=false
# Attempts per chance-based test case
E2E_CHANCE_ATTEMPTS=5
# Allowed number of failures while still returning success (use for chance-bot allowance)
E2E_FAILURE_THRESHOLD=1


# =============================================================================
# DEBUG AND TESTING CONFIGURATION
# =============================================================================
# Three-tier debug/testing configuration

# DEBUG_MODE: Enable verbose debug logging and development behaviors (true/false)
# IMPORTANT FOR COVABOT: When DEBUG_MODE=true, CovaBot will ONLY respond to COVA_USER_ID
# This creates a calibration/testing mode where Cova can talk to the bot for testing
DEBUG_MODE=false

# COVA_USER_ID: Discord user ID for Cova (used for debug mode filtering)
# In DEBUG_MODE, CovaBot will ONLY respond to this user ID
COVA_USER_ID=139592376443338752

# TESTING_SERVER_IDS: Comma-separated list of Discord server/guild IDs to restrict bot to
# When set, bot will ONLY process messages from these servers
# When empty, bot processes messages from any server
# Example: TESTING_SERVER_IDS=753251582719688714,987654321098765432
# TESTING_SERVER_IDS=

# TESTING_CHANNEL_IDS: Comma-separated list of Discord channel IDs to restrict bot to
# When set, bot will ONLY process messages from these channels
# When empty, bot processes messages from any channel
# Example: TESTING_CHANNEL_IDS=123456789012345678,987654321098765432
# TESTING_CHANNEL_IDS=

# E2E Test Configuration (for automated testing only)
# These IDs are used by E2E tests to verify bot identity resolution
# Only needed when running E2E tests - not required for normal operation
# E2E_TEST_MEMBER_ID=your-test-member-discord-id
# E2E_ID_VENN=your-venn-test-id
# E2E_ID_GUY=your-guy-test-id
# E2E_ID_SIGGREAT=your-sig-test-id

# Logging configuration
LOG_LEVEL=info

# Environment
NODE_ENV=development

# =============================================================================
# CENTRALIZED MESSAGE FILTERING CONFIGURATION
# =============================================================================
# Configuration for the centralized message filtering system

# Comma-separated list of bot user IDs that can bypass default bot filtering
# This includes other authorized bots
BOT_WHITELIST_IDS="836445923105308672"

# Comma-separated list of bot names that have inverse behavior (only respond to bots)
# Default includes BotBot which only responds to other bot messages
INVERSE_BEHAVIOR_BOTS="BotBot"

# =============================================================================
# ADDITIONAL GUILD CONFIGURATION
# =============================================================================
# Additional guild IDs for specific environments (optional)

# STARBUNK_STAGING_GUILD_ID=856617421427441674
# SNOWFALL_GUILD_ID=696689954759245915
# COVADAX_GUILD_ID=798613445301633134

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================
# Security keys and tokens (if needed)

# JWT_SECRET=your-jwt-secret-here
# API_KEY=your-api-key-here

# =============================================================================
# SETUP INSTRUCTIONS
# =============================================================================
# 1. Copy this file to .env: cp .env.example .env
# 2. Replace all "your-*-here" values with actual tokens/keys/passwords
# 3. Update IP addresses (192.168.50.3) to match your network setup
# 4. Set GUILD_ID to your Discord server ID
# 5. Configure observability stack URLs for your LAN
# 6. Never commit your .env file to version control!
#
# For Discord bot setup instructions, see the Discord section comments above.
# For observability setup, see OBSERVABILITY.md
