services:
  bluebot:
    image: ghcr.io/andrewgari/bluebot:latest
    container_name: starbunk-bluebot
    restart: unless-stopped
    env_file:
        - .env
    environment:
        - NODE_ENV=production
        - DISCORD_TOKEN=${BLUEBOT_TOKEN}
    ports:
        # Metrics and health endpoint port
        - '${BLUEBOT_METRICS_PORT:-9302}:3000'
    depends_on:
        redis:
            condition: service_healthy
    networks:
        - starbunk-network
    logging:
        driver: 'json-file'
        options:
            max-size: '10m'
            max-file: '3'
    labels:
        - com.starbunk.service=bluebot
        - prometheus.io/scrape=true
        - prometheus.io/path=/metrics
        - prometheus.io/port=3000
    deploy:
        resources:
            limits:
                memory: 512M
            reservations:
                memory: 256M

